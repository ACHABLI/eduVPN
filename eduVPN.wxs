<?xml version="1.0" encoding="utf-8"?>
<!--
    eduVPN - End-user friendly VPN

    Copyright: 2017, The Commons Conservancy eduVPN Programme
    SPDX-License-Identifier: GPL-3.0+
-->
<Wix
    xmlns="http://schemas.microsoft.com/wix/2006/wi"
    xmlns:netfx="http://schemas.microsoft.com/wix/NetFxExtension"
    xmlns:bal="http://schemas.microsoft.com/wix/BalExtension">
    <Bundle
        UpgradeCode="{EF5D5806-B90B-4AA3-800A-2D7EA1592BA0}"
        Version="$(var.eduVPN.Version)"
        Name="!(loc.ApplicationName) $(var.eduVPN.Version)"
        Manufacturer="!(loc.ManufacturerName)"
        AboutUrl="https://eduvpn.org/"
        Copyright="!(loc.LegalCopyright)"
        IconSourceFile="eduVPN.Client\Resources\eduVPN.ico"
        Compressed="yes">

        <BootstrapperApplicationRef Id="WixStandardBootstrapperApplication.HyperlinkLicense">
            <bal:WixStandardBootstrapperApplication
                LicenseUrl=""
                SuppressOptionsUI="yes"/>

            <Payload
                Id="thm"
                Compressed="yes"
                Name="thm.xml"
                SourceFile="eduVPN.Install\eduVPN.thm.xml"/>

            <Payload
                Id="thm-en-US"
                Compressed="yes"
                Name="thm.wxl"
                SourceFile="eduVPN.Install\eduVPN.thm.wxl"/>

            <Payload
                Id="thm-nl-NL"
                Compressed="yes"
                Name="1043\thm.wxl"
                SourceFile="eduVPN.Install\eduVPN.thm.nl.wxl"/>

            <Payload
                Id="thm-sl-SI"
                Compressed="yes"
                Name="1060\thm.wxl"
                SourceFile="eduVPN.Install\eduVPN.thm.sl.wxl"/>

            <Payload
                Id="logo"
                Compressed="yes"
                Name="logo.png"
                SourceFile="eduVPN.Install\eduVPN.logo.png"/>
        </BootstrapperApplicationRef>

        <Chain>
            <!--
                .NET Framework
            -->
            <PackageGroupRef Id="NetFx45Redist"/>

            <!--
                TAP-Windows
            -->
            <MsiPackage
                Id="eduVPNTAPWinPre_x86"
                SourceFile="bin\Setup\eduVPNTAPWinPre_$(var.eduVPN.TAPWinPre.Version)_x86.msi"
                InstallCondition="NOT VersionNT64"/>

            <MsiPackage
                Id="eduVPNTAPWinPre_x64"
                SourceFile="bin\Setup\eduVPNTAPWinPre_$(var.eduVPN.TAPWinPre.Version)_x64.msi"
                InstallCondition="VersionNT64"/>

            <PackageGroupRef Id="TAPWindows921Redist"/>

            <!--
                OpenVPN
            -->
            <MsiPackage
                Id="eduVPNOpenVPN_x86"
                SourceFile="bin\Setup\eduVPNOpenVPN_$(var.eduVPN.OpenVPN.Version)_x86.msi"
                InstallCondition="NOT VersionNT64"/>

            <MsiPackage
                Id="eduVPNOpenVPN_x64"
                SourceFile="bin\Setup\eduVPNOpenVPN_$(var.eduVPN.OpenVPN.Version)_x64.msi"
                InstallCondition="VersionNT64"/>

            <!--
                Core
            -->
            <MsiPackage
                Id="eduVPNCore_x86"
                SourceFile="bin\Setup\eduVPNCore_$(var.eduVPN.Core.Version)_x86.msi"
                InstallCondition="NOT VersionNT64"/>

            <MsiPackage
                Id="eduVPNCore_x64"
                SourceFile="bin\Setup\eduVPNCore_$(var.eduVPN.Core.Version)_x64.msi"
                InstallCondition="VersionNT64"/>
        </Chain>
    </Bundle>
</Wix>
